/** @license
 * backbone-socketio 0.2.1
 * (c) 2013-2014 Josh Mock
 * This may be freely distributed under the MIT license. */
!function(){"use strict";var a=function(a,b,c){var d=function(a){var d=this;this.generateUuid4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return"y"===a&&(b=3&b|8),b.toString(16)})},this.mixins={collection:{initialize:function(){if(!(this instanceof b.Collection))throw new Error("This object is not a Backbone.Collection");var d=c.uniqueId("socketEventCollection"),e={id:d},f=this;this.socketId=d,this.on("add",function(b,d,f){f.triggeredBySocket||a.emit("Backbone.Collection.add",c.extend(c.clone(e),{model:b.toJSON(),modelSocketId:b.socketId,index:d.models.indexOf(b)}))}),this.on("remove",function(b,d,f){f.triggeredBySocket||a.emit("Backbone.Collection.remove",c.extend(c.clone(e),{modelSocketId:b.socketId}))}),this.on("sort",function(b,d){d.triggeredBySocket||a.emit("Backbone.Collection.sort",c.clone(e))}),a.on("Backbone.Collection.add",function(a){a.id===f.socketId&&(f.add(a.model,{at:a.index,triggeredBySocket:!0}),f.at(a.index).socketId=a.modelSocketId)}),a.on("Backbone.Collection.remove",function(a){if(a.id===f.socketId){var b;f.each(function(c){c.socketId===a.modelSocketId&&(b=c)}),f.remove(b,{triggeredBySocket:!0})}}),a.on("Backbone.Collection.sort",function(a){a.id===f.socketId&&f.sort({triggeredBySocket:!0})})}},model:{initialize:function(){if(!(this instanceof b.Model))throw new Error("This object is not a Backbone.Model");var c=this;c.cid=d.generateUuid4(),this.on("change",function(b,d){d.triggeredBySocket||a.emit("Backbone.Model.change",{id:c.id,cid:c.cid,updates:c.changed})}),a.on("Backbone.Model.change",function(a){(void 0!==c.id&&a.id===c.id||void 0===c.id&&a.cid===c.cid)&&c.set(a.updates,{triggeredBySocket:!0})})}}}};return d},b=this;if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(c,d){return a(b,c,d)});else if("undefined"!=typeof module&&module.exports){var c=require("backbone"),d=require("underscore");module.exports=a(b,c,d)}else b.BackboneSocketio=a(b,b.Backbone,b._)}();
//# sourceMappingURL=backbone-socketio.min.map